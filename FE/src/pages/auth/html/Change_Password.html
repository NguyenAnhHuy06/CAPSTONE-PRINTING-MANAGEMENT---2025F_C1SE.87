<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Change Password</title>
<link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
<link rel="stylesheet" href="/FE/src/pages/auth/css/Change_Password.css">
</head>
<body>

<div class="container">
  <div class="icon"><i class='bx bx-key'></i></div>
  <h2>Change Password</h2>
  <p>Enter current password, new password, confirm, then verify OTP.</p>
  
  <form id="setPasswordForm">
    <div class="input_box">
      <input id="currentPassword" type="password" placeholder="Current Password" required>
      <i class='bx bx-lock-alt'></i>
      <i class='bx bx-eye-closed toggle-pass' data-target="currentPassword"></i>
    </div>
    <div class="input_box">
      <input id="newPassword" type="password" placeholder="New Password" required>
      <i class='bx bx-lock-alt'></i>
      <i class='bx bx-eye-closed toggle-pass' data-target="newPassword"></i>
    </div>
    <div class="input_box">
      <input id="confirmPassword" type="password" placeholder="Confirm New Password" required>
      <i class='bx bx-lock-alt'></i>
      <i class='bx bx-eye-closed toggle-pass' data-target="confirmPassword"></i>
    </div>
    <button type="submit" class="btn">Send OTP</button>
    <div id="errorMsg" class="error-msg"></div>
  </form>
</div>

<script>
const correctOldPassword = "123456"; // ví dụ tạm
const errorMsg = document.getElementById("errorMsg");

document.getElementById("setPasswordForm").addEventListener("submit", e=>{
  e.preventDefault();
  const currentPass = document.getElementById("currentPassword").value;
  const newPass = document.getElementById("newPassword").value;
  const confirmPass = document.getElementById("confirmPassword").value;

  if(currentPass!==correctOldPassword){
    errorMsg.textContent = "Current password is incorrect!";
    errorMsg.style.display = "block";
    return;
  }
  if(newPass!==confirmPass){
    errorMsg.textContent = "New passwords do not match!";
    errorMsg.style.display = "block";
    return;
  }

  errorMsg.style.display = "none";
  sessionStorage.setItem("tempPassword", newPass);
  window.location.href="Verify_OTP.html";
});

// Toggle show/hide password
document.querySelectorAll(".toggle-pass").forEach(icon=>{
  icon.addEventListener("click", ()=>{
    const target = document.getElementById(icon.dataset.target);
    if(target.type === "password"){
      target.type = "text";
      icon.classList.replace('bx-eye-closed', 'bx-eye');
    } else {
      target.type = "password";
      icon.classList.replace('bx-eye', 'bx-eye-closed');
    }
  });
});
</script>

</body>
</html>
